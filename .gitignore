##History files importng 
LSF_data<- read.csv("C:/Users/chuka/Downloads/pub0818.csv")
View(LSF_data)
str(LSF_data)
dput(colnames(LSF_data))

##Cleaning Data
LSF_D<-LSF_data[,-c(1,2,3,6,8,15,14,16,17,18,19,20,21,22,23,25,26,28,29,30,31,34,35,39,40,41,42,43,44,45,47,48,49,50,51,52,53,54,55,56,57,58,59)]
View(LSF_D)
LSF_D1 <- LSF_D[!is.na(LSF_D$HRLYEARN),]
View(LSF_D1)
LSF_D2<-LSF_D1[,-c(8,12,16)]
View(LSF_D2)
colSums(is.na(LSF_D2))
LSF_D3 <- na.omit(LSF_D2[-10])
colSums(is.na(LSF_D3))
LSF_D3.2<-LSF_D3[!(LSF_D3$AGE_12==1),]
LSF_D3.3<-LSF_D3.2[!(LSF_D3.2$AGE_12==11),]
LSF_D3.4<-LSF_D3.3[!(LSF_D3.3$AGE_12==12),]
LSF_D3.2<-LSF_D3.4[!(LSF_D3.4$AHRSMAIN==0 & LSF_D3.4$ATOTHRS==0 ),]
View(LSF_D3.2)

##Some basic correlation & ploting
View(LSF_D3)
library(dummies)
LSF_D3a = subset(LSF_D3, select = c(1,2,3,4,5,6,10))
LSF_D3a$SEX = dummy(data = LSF_D3a$SEX)
cor(LSF_D3a)

#Corrgram of the entire dataset to be used
install.packages("corrgram")
library(corrgram)

corrgram(LSF_D3.2, order=NULL, lower.panel=panel.shade,
         upper.panel=NULL, text.panel=panel.txt,
         main="Labor force survey data")

#Level of education between male & female respondents
install.packages("ggplot2")
library(ggplot2)
ggplot(LSF_D3.2,aes(x = EDUC, fill = SEX)) + 
  theme_bw() + geom_bar()


# Re-assigning data type and structure
LSF_data2$PROV <- as.factor(LSF_data2$PROV)
LSF_data2$CMA <- as.factor(LSF_data2$CMA)
LSF_data2$LFSSTAT <- as.factor(LSF_data2$LFSSTAT)
LSF_data2$SEX <- as.factor(LSF_data2$SEX)
LSF_data2$MARSTAT <- as.factor(LSF_data2$MARSTAT)
LSF_data2$EDUC <- as.factor(LSF_data2$EDUC)

# Initail analysis of Male vs Female highest level of educational qualification using ggplot
install.packages("ggplot2")
library(ggplot2)
ggplot(LSF_data2,aes(x = EDUC, fill = SEX)) + 
  theme_bw() + geom_bar()
